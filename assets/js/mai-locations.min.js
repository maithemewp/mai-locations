window.initMap=function(){const e=new URL(window.location.href),t=document.querySelectorAll(".mailocations-map"),a=document.querySelectorAll(".mailocations-autocomplete"),n=document.querySelectorAll(".mailocations-filter"),o=document.querySelectorAll(".mailocations-filter-clear"),r=maiLocationsVars.defaults;var s=maiLocationsVars.params,i=maiLocationsVars.autoComplete,l=function(e,t){var a=new google.maps.Marker({position:new google.maps.LatLng(parseFloat(e.dataset.lat),parseFloat(e.dataset.lng)),map:t});if(t.markers.push(a),e.innerHTML){var n=new google.maps.InfoWindow({content:e.innerHTML});google.maps.event.addListener(a,"click",(function(){n.open(t,a)}))}},c=function(e){var t=new google.maps.LatLngBounds;for(const a of e.markers)t.extend({lat:a.position.lat(),lng:a.position.lng()});1===e.markers.length?e.setCenter(t.getCenter()):e.fitBounds(t)};for(const e of t){var d=e.querySelectorAll(".marker"),m=new google.maps.Map(e,{zoom:parseInt(e.dataset.zoom),mapTypeId:google.maps.MapTypeId.ROADMAP});m.markers=[];for(const e of d)l(e,m);new markerClusterer.MarkerClusterer({map:m,markers:m.markers});c(m)}var u=function(){Object.keys(r).forEach((t=>{if(t in s){var a=Array.isArray(s[t])?s[t].join():s[t].toString(),n=Array.isArray(r[t])?r[t]:r[t].toString();""!==a&&a!==n?e.searchParams.set(t,a):e.searchParams.delete(t)}})),window.location=e.href};a.forEach((e=>{var t=e.parentElement.parentElement.querySelectorAll(".mailocations-autocomplete-distance"),a=e.parentElement.parentElement.querySelectorAll(".mailocations-autocomplete-unit"),n=e.parentElement.querySelectorAll(".mailocations-autocomplete-clear")[0];t="undefined"!==t?t[0]:"",a="undefined"!==a?a[0]:"";const o=new google.maps.places.Autocomplete(e,i);o.addListener("place_changed",(function(){const t=o.getPlace();if(t&&t.geometry){var a=t.geometry.location.lat(),n=t.geometry.location.lng(),r=null,i=null;if(t.address_components){for(const e of t.address_components){var l=e.types[0];"country"===l&&(r=e.short_name),"administrative_area_level_1"===l&&(i=e.short_name)}r&&"US"===r&&i&&(s.state=i)}s.address=e.value,s.lat=a,s.lng=n,u()}})),t&&t.addEventListener("change",(function(){s.distance=this.value,s.address&&u()})),a&&a.addEventListener("change",(function(){s.unit=this.value,s.address&&u()})),n.addEventListener("click",(function(){var t=e.getAttribute("value");e.setAttribute("value",""),e.value="",s.address="",s.lat="",s.lng="",s.state="",s.province="",t&&u()}))})),n.forEach((e=>{var t;e.addEventListener("change",(function(){t="select"===this.tagName.toLowerCase(),s[this.dataset.filter]=this.dataset.filter in s?s[this.dataset.filter]:[],this.checked||t?t&&!this.value?s[this.dataset.filter]=[]:s[this.dataset.filter].push(this.value):s[this.dataset.filter].splice(s[this.dataset.filter].indexOf(this.value),1),u()}))})),o.forEach((e=>{e.addEventListener("click",(function(){Object.keys(s).forEach((e=>{s[e]=""})),u()}))}))};