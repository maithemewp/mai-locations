function initLocations(){function t(t,e){let n=null,a=document.querySelectorAll(t),o=a.length?a[0]:"";return o&&(n=o.value),n||e}function e(t=!1){if(!t&&i.length)return;let e=document.getElementsByTagName("main");e=e.length?e[0]:document.body,e.style.opacity=.5,Object.keys(r).forEach(t=>{if(t in c){var e=Array.isArray(c[t])?c[t].join():c[t].toString(),a=Array.isArray(r[t])?r[t]:r[t].toString();""!==e&&e!==a?n.searchParams.set(t,e):n.searchParams.delete(t)}}),window.location=n.href.replace(/\/page\/\d+/,"")}const n=new URL(window.location.href),a=document.querySelectorAll(".mailocations-map"),o=document.querySelectorAll(".mailocations-autocomplete"),s=document.querySelectorAll(".mailocations-filter"),i=document.querySelectorAll(".mailocations-filter-submit"),l=document.querySelectorAll(".mailocations-filter-clear"),r=maiLocationsVars.defaults,c=maiLocationsVars.params;maiLocationsVars.autoComplete;for(const e of a){let n=null,a=0,o=parseFloat(c.lat),s=parseFloat(c.lng);const i=e.querySelectorAll(".marker"),l=new google.maps.Map(e,{zoom:parseInt(e.dataset.zoom),mapTypeId:google.maps.MapTypeId.ROADMAP,center:o&&s?{lat:o,lng:s}:null});if(l.markers=[],o&&s){const e={path:"M96 0c35.346 0 64 28.654 64 64s-28.654 64-64 64-64-28.654-64-64S60.654 0 96 0m48 144h-11.36c-22.711 10.443-49.59 10.894-73.28 0H48c-26.51 0-48 21.49-48 48v136c0 13.255 10.745 24 24 24h16v136c0 13.255 10.745 24 24 24h64c13.255 0 24-10.745 24-24V352h16c13.255 0 24-10.745 24-24V192c0-26.51-21.49-48-48-48z",fillColor:"rgba(0,0,0,0.8)",fillOpacity:1,strokeWeight:0,scale:.05,anchor:new google.maps.Point(110,600)};n=new google.maps.Marker({position:{lat:o,lng:s},map:l,icon:e,animation:google.maps.Animation.DROP}),l.markers.push(n);let i=c.distance,r=c.unit;if(i||(i=t(".mailocations-autocomplete-distance",null)),r||(r=t(".mailocations-autocomplete-unit","mi")),console.log(i,r),i){a=parseFloat(i),"mi"===r?a*=1609.34:"km"===r&&(a*=1e3);new google.maps.Circle({strokeColor:"#ff0000",strokeOpacity:.5,strokeWeight:1,fillColor:"#ff0000",fillOpacity:.05,map:l,center:{lat:o,lng:s},radius:a})}}for(const t of i){var m=new google.maps.Marker({position:{lat:parseFloat(t.dataset.lat),lng:parseFloat(t.dataset.lng)},map:l});if(t.innerHTML){var u=new google.maps.InfoWindow({content:t.innerHTML});m.infowindow=u,m.addListener("click",function(){return this.infowindow.open(l,this)})}l.markers.push(m)}if(l.markers.length){new markerClusterer.MarkerClusterer({map:l,markers:l.markers});if(a){const t=l.getCenter(),e=a/111300,n=e,o=e/Math.cos(t.lat()*Math.PI/180),s=new google.maps.LatLngBounds(new google.maps.LatLng(t.lat()-n,t.lng()-o),new google.maps.LatLng(t.lat()+n,t.lng()+o));l.fitBounds(s)}else{const t=new google.maps.LatLngBounds;for(const e of l.markers)t.extend(e.getPosition());1===l.markers.length?l.setCenter(t.getCenter()):l.fitBounds(t)}}else l.setCenter({lat:37.0902,lng:-95.7129}),l.setZoom(4)}for(const t of o){let n=t.parentElement.parentElement.querySelectorAll(".mailocations-autocomplete-distance"),a=t.parentElement.parentElement.querySelectorAll(".mailocations-autocomplete-unit"),o=t.parentElement.querySelectorAll(".mailocations-autocomplete-clear")[0],s="true"===t.dataset.limitstate,l=t.dataset.countries,r=["geometry","name"],m={};s&&r.push("address_components"),l&&(m.country=l.split(",")),n="undefined"!==n?n[0]:"",a="undefined"!==a?a[0]:"";const u=new google.maps.places.Autocomplete(t,{fields:r,ComponentRestrictions:m});u.addListener("place_changed",function(){const e=u.getPlace();if(!e||!e.geometry)return;const n=e.geometry.location.lat(),a=e.geometry.location.lng();let o=null,s=null,i=null;if(e.address_components){for(const t of e.address_components){var l=t.types[0];"country"===l&&(o=t.short_name),"administrative_area_level_1"===l&&(s=t.short_name)}o&&("US"===o?s&&(c.state=s):i&&(c.province=i))}c.address=t.value,c.lat=n,c.lng=a}),n&&n.addEventListener("change",function(){c.distance=this.value,c.address&&e()}),a&&a.addEventListener("change",function(){c.unit=this.value,c.address&&e()}),o&&o.addEventListener("click",function(){var n=t.getAttribute("value");t.setAttribute("value",""),t.value="",c.address="",c.lat="",c.lng="",c.state="",c.province="",i.length&&t.focus(),n&&e()})}for(const t of s){let n,a;t.addEventListener("change",function(){n="select"===this.tagName.toLowerCase(),a="radio"===this.getAttribute("type"),c[this.dataset.filter]=this.dataset.filter in c?c[this.dataset.filter]:[],this.checked||n?n&&!this.value?c[this.dataset.filter]=[]:a||n?c[this.dataset.filter]=[this.value]:c[this.dataset.filter].push(this.value):c[this.dataset.filter].splice(c[this.dataset.filter].indexOf(this.value),1),e()})}for(const t of i)t.addEventListener("click",function(){this.innerHTML='&nbsp;<svg class="mailocations-loading-svg" width="36" height="12" viewBox="0 0 36 12" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<style>\n\t\t\t\t.mailocations-loading-svg {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 50%;\n\t\t\t\t\tleft: 50%;\n\t\t\t\t\ttransform: translate(-50%, -50%);\n\t\t\t\t}\n\t\t\t\t.mailocations-spinner {\n\t\t\t\t\tanimation: spinner_xe7Q .8s linear infinite;\n\t\t\t\t}\n\t\t\t\t.mailocations-spinner2 {\n\t\t\t\t\tanimation-delay: -.65s;\n\t\t\t\t}\n\t\t\t\t.mailocations-spinner3 {\n\t\t\t\t\tanimation-delay: -.5s;\n\t\t\t\t}\n\t\t\t\t@keyframes spinner_xe7Q{\n\t\t\t\t\t93.75%,100% { r:3px; }\n\t\t\t\t\t46.875% { r:.2px; }\n\t\t\t\t}\n\t\t\t\t</style>\n\t\t\t\t<circle class="mailocations-spinner" cx="4" cy="6" r="3"/>\n\t\t\t\t<circle class="mailocations-spinner mailocations-spinner2" cx="18" cy="6" r="3"/>\n\t\t\t\t<circle class="mailocations-spinner mailocations-spinner3" cx="30" cy="6" r="3"/>\n\t\t\t</svg>',e(!0)});for(const t of l)t.addEventListener("click",function(){Object.keys(c).forEach(t=>{c[t]=""}),e(!0)})}document.addEventListener("DOMContentLoaded",function(){if(document.querySelectorAll(".mailocations-map").length||document.querySelectorAll(".mailocations-autocomplete").length){const t=document.getElementById("mai-locations-js"),e=document.createElement("script");let n=`https://maps.googleapis.com/maps/api/js?key=${maiLocationsVars.apiKey}`;document.querySelectorAll(".mailocations-autocomplete").length&&(n+="&libraries=places"),e.src=n+="&loading=async",e.src=n+="&callback=initLocations",t.parentElement.insertBefore(e,t)}else initLocations()});